<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.6.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2018-02-24T12:24:20-05:00</updated><id>http://localhost:4000/</id><title type="html">Mike McLaughlin</title><subtitle>Personal website/blog of Mike McLaughlin, health economist in Maryland.
</subtitle><entry><title type="html">Thoughts on the Recent *Value in Health* Themed Section on Value Assessment Frameworks in the US</title><link href="http://localhost:4000/2018/02/24/value-assessment-questions.html" rel="alternate" type="text/html" title="Thoughts on the Recent *Value in Health* Themed Section on Value Assessment Frameworks in the US" /><published>2018-02-24T00:00:00-05:00</published><updated>2018-02-24T00:00:00-05:00</updated><id>http://localhost:4000/2018/02/24/value-assessment-questions</id><content type="html" xml:base="http://localhost:4000/2018/02/24/value-assessment-questions.html">&lt;h3 id=&quot;value-assessment-frameworks&quot;&gt;Value Assessment Frameworks&lt;/h3&gt;
&lt;p&gt;The ISPOR recently released an issue of Value in Health with a special focus on value asssessment frameworks in the US: &lt;a href=&quot;http://www.valueinhealthjournal.com/issue/S1098-3015(17)X0012-0&quot;&gt;link here&lt;/a&gt;. It’s a useful read if you want to get up to date on how major organizations approach the question of ‘How we should assess value in healthcare?’ In this post I wanted to touch on two thoughts I was left with after reading through the conclusions and recommendations.&lt;/p&gt;

&lt;h3 id=&quot;the-emphasis-on-technology-vs-practice&quot;&gt;The Emphasis on Technology vs Practice&lt;/h3&gt;
&lt;p&gt;The report puts a major emphasis on the value of medical technology–the vast majority of which can be described as pharmaceuticals and medical devices but could also include something like gene-editing technology.&lt;/p&gt;

&lt;p&gt;On some level this makes a lot of sense. The question of the efficacy/effectiveness of technology mostly revolves around comparisons of different technologies. Think about things like clinical trials, questions of ‘substantial equivalency’, comparative effectiveness research, etc..In most of these cases we are taking one technology and comparing it’s effectiveness/equivalency vis-a-vis another technology. From here it’s natural to add cost comparisons and all of a sudden you have a way to quantify ‘bang for your buck’ (i.e., do CEA, MCDA, ROI analyses, etc.. where there’s a dollar figure invovled).&lt;/p&gt;

&lt;p&gt;The place where I wish there was more…oomph…is in whether and how these frameworks should be used to determine the value of medical practice. By medical practice I’m not talking about real-world evidence studies which, to my mind, is largely intended to still assess the relative value of technologies, but in a way that deals with problems inherent to clinical trials&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. Instead, what I mean are questions about how providers should practice medicine-How often should a provider check in with a patient? When should you recommend a CT scan with and without contrasts as opposed to just one? Are annual A1c checks necessary all the time? All of these, to my mind, move away from the question of which technology to use in a relatively narrow decision context and instead moves to the question of what pattern of medical practice is optimal for a given patient over a certain length of time.&lt;/p&gt;

&lt;p&gt;To be fair, it’s not like the question of practice variation is ignored. My take-away from a lot of the ‘geographic variation in medical spending’ research is that practice variation, rather than the use of certain technologies &lt;em&gt;per se&lt;/em&gt;, can drive cost differences without a major change in outcomes. Also some of the frameowrks reviewed by the ISPOR taskforce, notably those from the medical/specialty societies, emphasize the consideration of care pathways and clinical guidelines which are essentially ways of encouraging providers to harmonize their practice patterns. Still, I’m struck by the volume of articles/research/thought that is given to the question of which technology is better as opposed to the question of how providers should practice. In my mind this is largely a data/measurement question-it’s a lot easier to measure whether a patient got drug A versus drug B than it is to measure whether a patient was ‘exposed’ to practice pattern A versus practice pattern B&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. While I’ve seen assessments of care pathways&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;, they are generally very complex and rely heavily on modeling (i.e., simulation) methods where we have to assume certain patterns rather than extracting patterns from real-world data.&lt;/p&gt;

&lt;p&gt;So, what does all of this mean? Obviously it’s important to compare the relative effectiveness of different technologies but, I guess my belief is if the goal of healthcare reform and change is to drive better outcomes at lower costs I think it’s a mistake to ignore or de-emphasize the potential for value assessment for medical practice.&lt;/p&gt;

&lt;h3 id=&quot;coverage-and-reimbursement-decisions-in-risk-sharing-arrangements&quot;&gt;Coverage and Reimbursement Decisions in Risk-Sharing Arrangements&lt;/h3&gt;
&lt;p&gt;The other thing that struck me about this report is the relative emphasis on health plans as the arbiters of reimbursement and coverage and, by extension, the group most likley to say ‘no’ when a new technology enters the market. While this is probably true now, I’m left wondering if it will be the case 5-10 years from now.&lt;/p&gt;

&lt;p&gt;Specifically, I’m seeing a lot of push for providers to bear the risk of health plan enrollees. This can happen with stuff like bundled payments, primary care capitation, episode-based payments, or shared savings arrangements where providers earn more if beneficiares medical expenditures are lower than expected. As there’s more and more of this type of contracting going on, I’m left wondering how much of a role plans and payors will have in determining reimbursement and coverage.&lt;/p&gt;

&lt;p&gt;Think about it. On the one hand, no one wants to be the group to say ‘no’. What governement agency or health plan wants to explain why a patient shouldn’t receive a treatment when there’s a chance, even a small one, of beneift? On the other hand, plans and agencies have a strong incentive for making these types of decisions in a world driven by fee-for-service. If providers are going to bill for therapy A at $10,000 and therapy B at $2,000 there’s an $8,000 incentive for plans to figure out ways to encourage therapy B–one of which is to go through and rigorously assess when therapy A is unlikely to provide strong clinical benefit. However, that incentive shifts if the plan says to a provider ‘here’s $9,000 for a member, you figure out how to use it’.&lt;/p&gt;

&lt;p&gt;Now, I’m not saying that plans and agencies will abdicate the role of reimbursement and coverage decision-makers, but it will be interesting to see how invested they are moving forward. I could easily see a path where the status quo remains because providers refuse to engage in extensive risk sharing, or because the fear of being perceived as uncaring or unsympathetic causes such backlash from providers that plans are forced to retain coverage decisions. On the other hand, I can also see a path where providers embrace the shared decision-making paradigm and are comfortable bringing cost into care decisions. In a third outcome, I could see providers and plans recognizing that someone has to say ‘no’, but because of unwillingness at an individual stakeholder level we see the formation and strengthening of centralized authorities (e.g., bigger, more influential non-profits like ICER or even a government agency dedicated to this type of questioning).&lt;/p&gt;

&lt;p&gt;Anyway, my point in all of this is to say that while plans/agencies are currently responsible for remibursement and coverage, I’m not sure if that’s going to hold true in a world of greater risk sharing. It will be interesting to see what happens.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;These are at least twofold: 1. The fact that trial particiapnts are generally healthier than the population where a technology will be used, and, 2. The fact that providers in trials will have better knowledge/skills/experience working with a technology compared with ‘everyday’ providers. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;This assumes it’s even possible to describe practice provided by say, 10,000 providers into a single, summary type of measure. Fortunately, though, this is an area where I think a lot of the work in statistical learning can make a difference. The field has done a lot of work on pattern recognitiion and detection &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://pathways.nice.org.uk/pathways/chronic-heart-failure&quot;&gt;Here’s an example from NICE&lt;/a&gt; &lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Value Assessment Frameworks The ISPOR recently released an issue of Value in Health with a special focus on value asssessment frameworks in the US: link here. It’s a useful read if you want to get up to date on how major organizations approach the question of ‘How we should assess value in healthcare?’ In this post I wanted to touch on two thoughts I was left with after reading through the conclusions and recommendations.</summary></entry><entry><title type="html">HEE-The R Way: Intro to Markov Modeling With heemod</title><link href="http://localhost:4000/hee_r/2018/02/11/hee-the-r-way-heemod.html" rel="alternate" type="text/html" title="HEE-The R Way: Intro to Markov Modeling With heemod" /><published>2018-02-11T00:00:00-05:00</published><updated>2018-02-11T00:00:00-05:00</updated><id>http://localhost:4000/hee_r/2018/02/11/hee-the-r-way-heemod</id><content type="html" xml:base="http://localhost:4000/hee_r/2018/02/11/hee-the-r-way-heemod.html">&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;This is the first post in what I’ll start calling the “Health Economics Evaluation: The R Way” series, in which I’ll provide tutorials on how to do common health economics tasks using R. The target audience would be people who have a bit of programming and data analysis skills, and want to learn how to use R for some of the common tasks used in health econmics/outcomes research. In each post I’ll try to give a little bit of background to the topic, but the major focus will be on how to do the programming. For better references, I’d recommend Neumann, et al’s. book, which is sort of a standard reference–&lt;a href=&quot;https://www.amazon.com/Cost-Effectiveness-Health-Medicine-Peter-Neumann/dp/0190492937/ref=sr_1_1?ie=UTF8&amp;amp;qid=1517673774&amp;amp;sr=8-1&amp;amp;keywords=costeffectiveness+in+health+and+medicine&quot;&gt;Amazon link&lt;/a&gt;– or the Handbooks in Health Economics series from Oxford Press–&lt;a href=&quot;https://www.amazon.com/Cost-effectiveness-Analysis-Healthcare-Handbooks-Evaluation/dp/0199227284/ref=sr_1_5?ie=UTF8&amp;amp;qid=1517673774&amp;amp;sr=8-5&amp;amp;keywords=costeffectiveness+in+health+and+medicine&quot;&gt;Amazon link&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This post covers an introduction to using the &lt;code class=&quot;highlighter-rouge&quot;&gt;heemod&lt;/code&gt; R package to do Markov modeling.&lt;/p&gt;

&lt;h2 id=&quot;markov-modeling-in-the-context-of-technology-evaluation&quot;&gt;Markov modeling in the context of technology evaluation&lt;/h2&gt;
&lt;p&gt;Let’s say we have a new therapy for multiple sclerosis (MS). For those who don’t know, MS is a degenerative disorder. This means means that over time the disease causes more and more damage, causing the symptoms that patients experience to worsen. Let’s also assume the manufacturer of this new therapy (say it’s a pill to be concrete…) wants to price the drug such that therapy would cost $40,000/yr. A lot of money right? An insurer (or in this case a pharmacy benefits manager since it’s a drug) might try to negotiate a lower price on the grounds that $40,000/yr is too much. There might already be an effective drug that costs $15,000/yr. The manufacturer could counter, saying that because their new drug slows disease progression much better than the old drug and, as a result, the manufacturer says insurers could actually save money because they have to pay for fewer rehabilitative services. You could imagine this sort of simple negotiating going back and forth. Ultimately, what would help here is a model that could help quanitfy the value of this new drug and compare that to the value of the old drug.&lt;/p&gt;

&lt;p&gt;In this case, a Markov model might help. Markov models are a mathetmatical tool that, in their simplest and most common form, treat individuals as belonging to a single state in a given point in time. Individuals are then assumed to transition to new states with a probability that only depends on their current state (this is the Markov property that gives these models their names).&lt;/p&gt;

&lt;p&gt;How can these tools be used to assess the value of drugs? Well, let’s say that we can treat the severity and symptoms of MS as a series of 3 states. Call them ‘low’, ‘medium’, and ‘high’ disease severity. We can say that an individual stays in each state for exactly 1 year, then transitions to a new state (or stays in their current state) based on a set of probabilities. Let’s say the drug affects these transition probabilities. Also, for each year someone is in a given state we can keep a running count of their expected medical expenditures. This would let us say something about that person’s anticipated costs. We could also describe the expected utility, or general quality of life, that someone experiences in each state and keep a running count of that as well.&lt;/p&gt;

&lt;p&gt;It’s probably easiest to understand if we actually get in and start programming a bit, so let’s do that.&lt;/p&gt;

&lt;h2 id=&quot;getting-started-in-r&quot;&gt;Getting started in R&lt;/h2&gt;
&lt;p&gt;To do Markov modeling we’ll be using the R &lt;code class=&quot;highlighter-rouge&quot;&gt;heemod&lt;/code&gt; package. You’ll first need to see if you have the package installed and, if you don’t, you’ll need to download it from CRAN. To check if you have a package installed you can run &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;heemod&quot; %in% rownames(installed.packages()&lt;/code&gt; which will check for the name ‘heedmod’ in the list of all packages you have installed. If you don’t have it installed (i.e., the command above returns &lt;code class=&quot;highlighter-rouge&quot;&gt;FALSE&lt;/code&gt;), you can run &lt;code class=&quot;highlighter-rouge&quot;&gt;install.packages(&quot;heemod&quot;)&lt;/code&gt; which, if you’re connected to the internet, will automatically download the package from CRAN. Once you’ve downloaded the package you can get started by calling &lt;code class=&quot;highlighter-rouge&quot;&gt;library(heemod)&lt;/code&gt;. So, your script should simply be:&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#To check if you have the package installed you could run: &quot;heemod&quot; %in% rownames(installed.packages())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Otherwise be sure to install the package-&amp;gt;install.packages(&quot;heemod&quot;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heemod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;defining-transition-matrices&quot;&gt;Defining transition matrices&lt;/h2&gt;
&lt;p&gt;Once the package is loaded you can start defining states and transition probabilities. Let’s again say we have three states: ‘low’, ‘medium’ and ‘high’. We can define a set of transition probabilities between the states in a table where the row indicates the starting state, and the column indicates the ending state. These probabilities could be based on results of clinical studies or based on expert opinion or some other source. Also, note that we have to specify probabilities, not percentages. Probabilities have to be numbers between 0.0 and 1.0.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Medium&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Low&lt;/td&gt;
      &lt;td&gt;0.70&lt;/td&gt;
      &lt;td&gt;0.20&lt;/td&gt;
      &lt;td&gt;0.10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Medium&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.70&lt;/td&gt;
      &lt;td&gt;0.30&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;High&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;We’d read this table by looking for someone’s current state in the row, and then reading off the probability of ending up in the next state from the columns. So, for example, our table says that someone who is currently ‘low’ severity has a probability of 0.70 (or, 70% chance) of staying in ‘low’ severity next year, a probability of 0.20 of transitioning to ‘medium’ severity, and a probability of 0.10 of transitioning to ‘high’ severity. Note that the transition probability for someone in a ‘high’ state is 1.0, which says that someone who is currently severly impacted cannot reduce their disease severity.&lt;/p&gt;

&lt;p&gt;Ok, let’s say the table above captures the transition probabilities for the old drug. Let’s now specify the transition probabilites for the new drug (the one costing $40,000/yr). Again, these probabilties could be absed on results of a clinical trial or similar:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Medium&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Low&lt;/td&gt;
      &lt;td&gt;0.80&lt;/td&gt;
      &lt;td&gt;0.15&lt;/td&gt;
      &lt;td&gt;0.05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Medium&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.85&lt;/td&gt;
      &lt;td&gt;0.15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;High&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;If you compare these tables you’ll see that the new drug makes it more likely that someone will stay in lower disease severity. For example, with the old drug, someone who is currently ‘low’ has a 20% chance of transitioning to ‘medium’. With the new drug this chance is only 15%.&lt;/p&gt;

&lt;p&gt;We can encode these transition probabilities in R by using the &lt;code class=&quot;highlighter-rouge&quot;&gt;define_transition&lt;/code&gt; function. Here’s an example:&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;trans_old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_transition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s print the matrices:&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;trans_old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## A transition matrix, 3 states.
## 
##   A   B   C  
## A 0.7 0.2 0.1
## B     0.7 0.3
## C         1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;trans_new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## A transition matrix, 3 states.
## 
##   A   B    C   
## A 0.8 0.15 0.05
## B     0.85 0.15
## C          1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We see that the matrix states are generically named ‘A’, ‘B’, and ‘C’. We can add names to make things easier to follow. To do this, we’ll modify the attributes (kind of like meta-data) of our transition matrix objects. &lt;a href=&quot;http://www.dummies.com/programming/r/how-to-play-with-attributes-in-r/&quot;&gt;Here’s an article&lt;/a&gt; to get better understanding of attributes in R.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;low&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;medium&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;high&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'state_names'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'state_names'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## A transition matrix, 3 states.
## 
##        low medium high
## low    0.7 0.2    0.1 
## medium     0.7    0.3 
## high              1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;visualizing-the-transitions&quot;&gt;Visualizing the transitions&lt;/h2&gt;
&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;heemod&lt;/code&gt; package has some nice functions available that use &lt;code class=&quot;highlighter-rouge&quot;&gt;ggplot2&lt;/code&gt; and other packages to visualize models and results (note: you may need to install these packages. For exmaple, I initially got an error saying the &lt;code class=&quot;highlighter-rouge&quot;&gt;diagram&lt;/code&gt; package was required for plotting, so I needed to install it). For example, we can visualize our transitions by calling &lt;code class=&quot;highlighter-rouge&quot;&gt;plot&lt;/code&gt; on our transition matrices. Here’s a plot for the transition matrix with the old drug.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## Loading required namespace: diagram
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/images/hee-the-r-way-heemod-plot_trans-1.png&quot; alt=&quot;plot of chunk plot_trans&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;adding-values-to-states&quot;&gt;Adding values to states&lt;/h2&gt;
&lt;p&gt;The next thing we’ll want to do is add value information to our different states. This value information is how we can specify, for example, an individual’s costs and health related quality of life. Since we ultimately want to compare drugs, we’ll need to specify values for each drug. To do this we’ll use a combination of &lt;code class=&quot;highlighter-rouge&quot;&gt;define_state&lt;/code&gt; to define values for a particular state and &lt;code class=&quot;highlighter-rouge&quot;&gt;dispatch_strategy&lt;/code&gt; to tell R that we want the value to depend on which ‘strategy’ (new or old drug) we are using. Our cost information could again come from clinical studies, observational data, etc.. We’ll assume that, exlcuding drug costs, if someone spends a year in a ‘low’ state they incur $20,000, if they are ‘medium’ they incur $40,000, and in a ‘high’ state they incur $100,000. We’ll also add the drug costs-$15,000/yr for the old drug and $40,000/yr for the new drug.&lt;/p&gt;

&lt;p&gt;Note that, by default, &lt;code class=&quot;highlighter-rouge&quot;&gt;heemod&lt;/code&gt; models want to do cost-effectiveness analysis (something we won’t cover in depth yet). For this reason when you define a state you need to specify both a cost aspect &lt;em&gt;and&lt;/em&gt; and effect aspect. Here we’ll just code effect as &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt; although in reality this effect would be something like years of life or quality-adjusted life years (QALYs).&lt;/p&gt;

&lt;p&gt;Here’s the code:&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;state_low&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dispatch_strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_med&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dispatch_strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_high&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dispatch_strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;putting-states-and-transitions-together-to-make-a-model&quot;&gt;Putting states and transitions together to make a model&lt;/h2&gt;
&lt;p&gt;Finally, we’re ready to combine our states and our transition probabilities together. We’ll do this by creating a ‘strategy’ for each of the drugs using &lt;code class=&quot;highlighter-rouge&quot;&gt;define_strategy&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;strat_old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;medium&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_med&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_high&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strat_new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define_strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trans_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;medium&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_med&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_high&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we can actually run our model by calling &lt;code class=&quot;highlighter-rouge&quot;&gt;run_model&lt;/code&gt;. In this instance, we’ll run the model for a hypothetical population of 500 people all starting at low severity in year 1, and we will run the model for 5 years (that is, at the end of each year we will transition individuals based on the transition matrix). We specify costs and effects as the ‘cost’ and ‘effect’ parts in our states defined above.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mod_rslt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strat_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strat_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Run for five years&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cycles&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Hypothetical population of 500 identical people, all starting at low severity&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;effect&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mod_rslt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## 2 strategies run for 5 cycles.
## 
## Initial state counts:
## 
## low = 500
## medium = 0
## high = 0
## 
## Counting method: 'life-table'.
## 
## Values:
## 
##          cost effect
## old 130028448   2500
## new 192528448   2500
## 
## Efficiency frontier:
## 
## old
## 
## Differences:
## 
##     Cost Diff. Effect Diff. ICER Ref.
## new     125000            0  Inf  old
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, we can read from this model that in this hypothetical population of 500 people the total cost over 5 years if they all took the new drug would be $192,528,448 versus $130,028,448 for the old drug or $125,000 more per person over five years. So, this model suggests the manufacturer is wrong–it will cost payers more to switch to the new drug.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;This post should give enough to get someone started with building their own Markov models in R. In future posts I’ll show how to extend this functionality so models can become more flexible. For example, showing how you can allow probabilities or costs to vary based on individual demographics. I’ll also show how this Markov modeling can be integrated with other R functionality, making it faster and easier to execute very complex analyses.&lt;/p&gt;</content><author><name></name></author><summary type="html">Introduction This is the first post in what I’ll start calling the “Health Economics Evaluation: The R Way” series, in which I’ll provide tutorials on how to do common health economics tasks using R. The target audience would be people who have a bit of programming and data analysis skills, and want to learn how to use R for some of the common tasks used in health econmics/outcomes research. In each post I’ll try to give a little bit of background to the topic, but the major focus will be on how to do the programming. For better references, I’d recommend Neumann, et al’s. book, which is sort of a standard reference–Amazon link– or the Handbooks in Health Economics series from Oxford Press–Amazon link.</summary></entry></feed>